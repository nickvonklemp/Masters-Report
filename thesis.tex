%=====================================================================
%	UCT MECHATRONICS GROUP TEMPLATE
%---------------------------------------------------------------------
%	Template made by:		R.A. Verrinder
% 	Written  by:	N.R. Von Klemperer
%	Date Modified:	June 2016
%---------------------------------------------------------------------
%	Compile with:	TexMaker 
%=====================================================================
%	Document properties:
%---------------------------------------------------------------------
%	Paper size:			A4
%	Margins:			1 inch margins(top,bottom,left,right)
%	Printing:			Double sided (twoside book)
%	Base font size:		11pt
%	Line spacing:		
%	Paragraph spacing:	10pt
%	Paragraph indent:	0pt
%=====================================================================

\documentclass[a4paper, 11pt, oneside, openright, parskip=full]{book}

%---------------------------------------------------------------------
%	PACKAGES
%---------------------------------------------------------------------
\usepackage{afterpage}
\usepackage[margin = 2cm]{geometry}		
\usepackage{lscape}
\usepackage{rotating}
\usepackage{hyphenat}
\usepackage{setspace}
\usepackage{hyperref}
\usepackage{titlesec}
\usepackage{lastpage}
\usepackage{fancyref}
\usepackage{fancyvrb}
\usepackage{cite}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{graphicx}					% Can include graphics
\usepackage{float}						% Can place figures at exact places in text
\usepackage{wrapfig}					% Can wrap text around figures
\usepackage{import}

\usepackage{array}						% Can set column widths in tables
\usepackage{mdframed}					% Can draw boxes around text etc.
\usepackage{subcaption}					% Can place figures side by side
\usepackage{tikz}
\usetikzlibrary{positioning}		
\usetikzlibrary{shapes.geometric, arrows} % For block diagrams
\usetikzlibrary{circuits.logic.US} 
\usetikzlibrary{calc}
\usepackage[siunitx]{circuitikz}		% Can draw circuits
\usepackage{tikz-timing}				% Can draw timing diagrams
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{xspace}						% For box spaces
\usepackage{caption}					% Captions and subcaptions
\usepackage{tabularx}
\usepackage{fix-cm}						% Can set font size
\usepackage{color}						% Can change font color

\usepackage[scaled=0.9]{helvet}			% Helvetica font scaled \phv
\usepackage{courier}					% Courier font \pcr
%\usepackage{mathptmx}					% Times New Roman font
%\usepackage{cmbright}					% Sans serif font
%\normalfont 							% in case the EC fonts aren't available
%\usepackage[T1]{fontenc}				% Used to switch to type 1 font encoding
\usepackage{textcomp}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{datetime}					% Can use dates and times
\usepackage{gensymb}				
\usepackage{ragged2e}
\usepackage{multirow}
\usepackage{hhline}
\usepackage{amsmath}
\usepackage{wrapfig}
\usepackage{tablefootnote}
%\usepackage[all]{nowidow}
%---------------------------------------------------------------------
% 	PAGE FORMATTING
%---------------------------------------------------------------------
% Include page formatting here. 
%---------------------------------------------------------------------
\parskip	= 10pt						% Paragraph spacing
\parindent 	= 0pt						% No para. indent

% Caption margins 80% of text
\captionsetup{width=0.8\textwidth,font=small,labelfont=bf}		

%---------------------------------------------------------------------
%	DOCUMENT PROPERTIES
%---------------------------------------------------------------------
\newcommand{\auth}{Nicholas Von Klemperer}								% Author
\newcommand{\titl}{Dual-Axis Tilting Quadrotor Aircraft}						% Thesis title
\newcommand{\subtitle}{An investigation into the overactuatedness and control thereof}						% Thesis subtitle
\newcommand{\dept}{Department of Electrical Engineering}% Department 
\newcommand{\uni}{University of Cape Town}				% University
\newcommand{\city}{Rondebosch, Cape Town}				% City
\newcommand{\country}{South Africa}						% Country
\newcommand{\degre}{Masters of Science}				% Degree (Doctor of Philosophy 
														% or Master of Science)
\newcommand{\degreeabv}{MSc}							% Degree abbreviation (PhD or MSc.)			
\newcommand{\aemail}{Nicholas.VonKlemperer@alumni.uct.ac.za}			% Author email address
\newcommand{\supervisor}{Supervisor}					% Supervisor
\newcommand{\hod}{Prof. E. Boje}						% Head of Department

\newcommand{\logo}										% UCT Logo
{	
	\includegraphics[scale = 0.3]{figs/uctLogo}
}

\newdateformat{mydate}{\monthname[\THEMONTH] \THEYEAR} % Month Year date
\newcommand{\key}{Non-linear, control, allocation, quadrotor, UAV}					   % Keywords (add logical keywords)
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
%---------------------------------------------------------------------
%	MACROS
%---------------------------------------------------------------------
% Signature box
%---------------------------------------------------------------------
\newcommand*{\signature}[1]
{
	\par\noindent\makebox [5cm]{\hrulefill}
	\par\noindent\makebox [5cm][1]{#1}
}
%---------------------------------------------------------------------
% Macro to select font style
% phv = helvetica (sans serif)
% pcr = courier	  (typewritter font)
%---------------------------------------------------------------------
\def\nfont#1#2
{
	{\fontfamily{#1}\selectfont #2}
}					
%---------------------------------------------------------------------
% Creates an block for a block diagram
%---------------------------------------------------------------------
\tikzstyle{arrow}=[->,shorten <=1pt,>=stealth',semithick]
%---------------------------------------------------------------------
%block 1
%---------------------------------------------------------------------
\tikzstyle{block}=[rectangle,
				   draw=black,
				   fill=gray!10,
				   thick, 
				   minimum height = 2cm, 
				   text width=0.15*\columnwidth,]
\tikzstyle{input}  		= [coordinate]
\tikzstyle{output} 		= [coordinate]
\tikzstyle{pinstyle} 	= [pin edge={to-,thin,black}]
\tikzstyle{sum} 		= [draw, fill=blue!20, circle, node distance=1cm]
%---------------------------------------------------------------------
%block 2
%---------------------------------------------------------------------
\tikzstyle{block2}=[rectangle,
				   draw=black,
				   fill=gray!10,
				   thick, 
				   minimum height = 1.8cm, 
				   text width=0.1*\columnwidth,]
\tikzstyle{input}  		= [coordinate]
\tikzstyle{output} 		= [coordinate]
\tikzstyle{pinstyle} 	= [pin edge={to-,thin,black}]
\tikzstyle{sum} 		= [draw, fill=blue!20, circle, node distance=1cm]
%---------------------------------------------------------------------
%flow charts
%---------------------------------------------------------------------
\tikzstyle{state}     = 	[rectangle, 
							 text width=0.15*\columnwidth=2cm, 
							 minimum  height=1.5cm, 
							 text centered, 
							 draw=black]
							 
\tikzstyle{statement}  = 	[rectangle, 
							 text width=0.15*\columnwidth=2cm, 
							 minimum  height=0.5cm, 
							 text centered, 
							 draw=black]							 
							 
\tikzstyle{condition}  = 	[rectangle, 
							 text width=0.15*\columnwidth=2cm, 
							 minimum  height=1cm, 
							 rounded corners =10pt,
							 text centered, 
							 draw=black]
\tikzstyle{decision}  = 	[diamond, 
			                 minimum width=2cm, 
			                 minimum height=1cm, 
			                 text centered, 
			                 draw=black]
\tikzstyle{line} = [draw, -latex']

%=====================================================================
%	Start of the document
%---------------------------------------------------------------------
\begin{document}

%=====================================================================
%	TITLE PAGE
%=====================================================================
\begin{titlepage}
	\centering
	\vspace*{1cm}

%---------------------------------------------------------------------
% Title
%---------------------------------------------------------------------	
	\begin{Huge}					
		\bfseries\titl\par
		\vskip 5mm
		%\hrule
		%\vskip 1.2cm
	\end{Huge}
%---------------------------------------------------------------------
% Subtitle	(optional)
%---------------------------------------------------------------------
	\begin{Large}					
		\subtitle\\*
		\vskip 3cm
	\end{Large}
%---------------------------------------------------------------------
% UCT logo
%---------------------------------------------------------------------	
	\logo							
	\vskip 1.5cm	
%---------------------------------------------------------------------
% Author	
%---------------------------------------------------------------------	
	\begin{Large}					
		\bfseries\auth\\
	\end{Large}
%---------------------------------------------------------------------
% Author's address	
%---------------------------------------------------------------------		
	\begin{normalsize}				
		\vskip 2mm	
		\dept\\*
		\uni\\*
		\city\\*
		\country\\*
		
		\vskip 15mm	
	\end{normalsize}
%---------------------------------------------------------------------
% Supervisor (optional)	
%---------------------------------------------------------------------		
%	\begin{large}					
%		{\itshape Supervisor: \\*}
%		\supervisor\\
%		\vskip 5mm
%	\end{large}
%---------------------------------------------------------------------
% Date	
%---------------------------------------------------------------------
	\begin{Large}					
		{\bfseries \mydate\today}
		\vskip 15mm	
	\end{Large}
%---------------------------------------------------------------------
% Degree	
%---------------------------------------------------------------------		
		\degreeabv\ thesis submitted in fulfilment of the requirements for the degree of \degre\ in the \dept\ at the \uni
		
		\vskip 15mm	
%---------------------------------------------------------------------
% Keywords	
%---------------------------------------------------------------------		
	\begin{normalsize}				
		{\itshape Keywords:}
		\key			
	\end{normalsize}	
\end{titlepage}
\afterpage{\null\newpage}
%=====================================================================
%	FRONT MATTER
%=====================================================================
\frontmatter
\begin{center}
\begin{minipage}{0.7\textwidth}
\centering
"\emph{We're gonna have a superconductor turned up full blast and pointed at you for the duration of this next test. I'll be honest, we're throwing science at the wall here to see what sticks. No idea what it'll do. Probably nothing. Best-case scenario, you might get some superpowers\ldots}"
\\
Cave Johnson -Founder \& CEO of Aperture Science
\end{minipage}
\end{center}
%---------------------------------------------------------------------
%	Declaration
%---------------------------------------------------------------------
\chapter{Declaration}				
\label{ch:decl}
% Change name
I, \auth,  hereby:

\begin{enumerate}
	\item		grant the \uni\  free license to reproduce the above thesis in whole or in part, for the purpose of research only;
	\item		declare that:
	
	\begin{enumerate}
		\item		This thesis is my own unaided work, both in concept and execution, and apart from the normal guidance from my supervisor, I have received no assistance except as stated below:
				% Note any exceptions
		\item		Neither the substance nor any part of the above thesis has been submitted in the past, or is being, or is to be submitted for a degree at this University or at any other university, except as stated below.
		\item		Unless otherwise stated or cited, any and all illustrations or diagrams demonstrated in this work are my own productions.
				% Note any exceptions
		\item 		All the content used to compile this report and complete the investigation revolving around the whole project is collectively hosted on the following GIT repositories:
		\begin{itemize}
			\item \LaTeX report: \url{https://github.com/nickvonklemp/Masters-Report}
			\item STM32F303 Projects: \url{https://github.com/nickvonklemp/Code}
			\item Design Files \& Blue Prints: \url{https://github.com/Design}
			\item Hardware Schematics: \url{https://github.com/nickvonklemp/visio} \&
			\item EagleCad Schematics \url{https://github.com/nickvonklemp/Eagle}
			\item MatLab Simulink Code: \url{https://github.com/nickvonklemp/Simulink}
			\item Results \& Simulation Data: \url{https://github.com/nickvonklemp/results}
		\end{itemize}
	\end{enumerate}	
\end{enumerate}

\begin{flushright}	% Signature field
	\vskip 4cm
	\noindent \signature{x}
	\noindent \auth \\*
	\vskip 2mm
	\noindent \dept \\*
	\noindent \uni \\*
	\vskip 2mm
	\noindent \today
\end{flushright}
%---------------------------------------------------------------------
%	Abstract
%---------------------------------------------------------------------
\chapter{Abstract}				
\label{ch:abs}
%---------------------------------------------------------------------
\begin{center}
	\textbf{\Large \titl}\\
			\vskip 0.2cm
			\auth\\
			\vskip 0.2cm
	\textit{\footnotesize\today}
			\vskip 1cm
\end{center}
%---------------------------------------------------------------------
The aim of this project is to design, simulate and control a novel quadrotor platform which can articulate all 6 Degrees of Freedom by vectoring each propeller's directional thrust. To achieve this the structure of the air-frame must redirect those thrust vectors to any desired orientation. This means it has to transform its configuration during flight, redirecting lift actuators whilst still maintaining stable attitude \& position control, despite of such relative motion. In view of this required articulation the proposal is to add 2 axes (degrees) of extra actuation to each propeller. As a result each lift propeller can then be pitched or rolled relative to the body frame. This adaptation, to what is an otherwise well covered and highly researched platform, produces an over-actuated control problem. Actuator control allocation in the context of aerospace platforms is the primary contribution of this paper, with novel elements of non-linear (\emph{state-space}) attitude control and plant uncertainty compensation.
\par
The structure of the dissertation first presents the design which the subsequent dynamics and control are derived with respect to. Following that, the kinematics associated with rigid bodies are derived. Any unique effects that could apply to the design like gyroscopic, inertial and aerodynamic responses are investigated and then incorporated into the dynamics. Position and attitude control algorithms are first derived, then simulated and compared based on the plant's dynamics (\emph{which include discretionary effects on the system}). The relative performance of the controllers are evaluated but regular performance metrics for attitude and position control are ill-suited for such a system. Some time is spent discussing the consequence of this and how the controllers are actually evaluated. Finally the design is built and tested using readily available RC components and conclusions drawn on the success or failure of the design.
\par
The purpose of the investigation is the practicality and feasibility of such a design, most importantly whether the complexity of the mechanical design is a decent compromise for the added degrees of control actuation. The outcome of the build is to ascertain if it's economically feasible (cost and controller effort) to use such a prototype to expand the range of a quadrotor's motion. The design and control treatment presented here are by no means optimal nor the most exhaustive solutions, focus is placed on the system as a whole and not just one aspect of it.
\par
\emph{This dissertation report is presented in a logical progression of concepts and information. In some cases the research and results were completed in a different order from how they're listed here\ldots}
%---------------------------------------------------------------------
%	Acknowledgements
%---------------------------------------------------------------------
\chapter{Acknowledgements}		
\label{ch:ack}
%---------------------------------------------------------------------



%---------------------------------------------------------------------
%	Nomenclature
%---------------------------------------------------------------------
\chapter{Nomenclature}
\label{ch:nom}
%---------------------------------------------------------------------
\underline{In order of appearance:}
\par
DOF - Degree of Freedom(s)\\
$\mu$C - micro-controller\\
UAV - Unmanned aerial vehicle\\
SISO - Single input single output, control loop\\
MEMS - Micro-electromechanical system\\
DIY - Do it yourself\\
VTOL - Vertical takeoff/landing\\
IMU - Inertial measurement unit\\
BLDC - Brushless direct current, motor type\\
KV - Kilo-volt, BLDC motor rating\\
$\mu$C - Micro-controller shorthand\\
PWM - Pulse width modulation\\
CH - Channel, radio control \& PWM signals typically\\
RC - Radio control\\
OAT - Opposed active tilting\\
dOAT - Dual axis opposed active tilting\\
PD - Proportional derivative, control law\\
PID - Proportional integral derivative, control law\\
IBC - Ideal backstepping control\\
ABC - Adaptive backstepping control\\
PSO - Particle swarm optimization, gradient free genetic algorithm\\
BEM - Blade element theory\\
ESC - Electronic speed controller\\
MPC - Model predictive control\\
LQR - Linear quadratic regulator\\
LCF - Lyupanov candidate function\\
ITAE - Integral time additive error\\
TSK - Takagi-Sugeno-kang\\
I/O - Input/Output\\
RPM - Revolution Per Minute\\
RPS - Revolution Per Second\\
W.R.T - With respect to\\
LCF - Lyupanov Candidate Function\\
\emph{iff} - If and only if\\
P.D - Positive definite, NOT proportional derivative\\
S.T - such that

%---------------------------------------------------------------------
%	Symbols
%---------------------------------------------------------------------
\chapter{Symbols}
\label{ch:symbol}
%---------------------------------------------------------------------
Propeller Rotational Speed: $\Omega_i~~[rpm]~~\text{for motors:}~~i\in\begin{bmatrix}
1,&2,&3,&4
\end{bmatrix}$
\\
\emph{\color{Gray} Rotational speeds in [RPS] are used for Blade Element Theory Calculations in Chapter:\ref{ch:dynamics}}
\\
Net body torque: $\mu\vec{\tau}=\begin{bmatrix}
\tau_\phi & \tau_\theta & \tau_\psi
\end{bmatrix}\text{}^T~~~~\in\mathcal{F}^b$
\\
Net body thrust: $\mu\vec{T}=\begin{bmatrix}
T_x & T_y & T_z
\end{bmatrix}\text{}^T~~~~\in\mathcal{F}^b$
\\
Body Position: $\vec{\mathcal{E}}=\begin{bmatrix}
x & y & z
\end{bmatrix}^T~~~~\in\mathcal{F}^I$
\\
Euler Angles: $\vec{\mathcal{E}}=\begin{bmatrix}
\phi & \theta & \psi
\end{bmatrix}^T~~~~\in\mathcal{F}^{I,v1,b}$
\\
Servo 1 Position: $\lambda_i~~[rad]$
\\
Servo 2 Position: $\alpha_i~~[rad]$
\\
Motor module actuator positions: $\begin{bmatrix}
\Omega_i & \lambda_i & \alpha_i
\end{bmatrix}^T~~~~\in\mathcal{F}^{M_i}$
\\
Actuator matrix: $u=\begin{bmatrix}
M_1 & \ldots & M_4
\end{bmatrix}~~~~\in\mathbb{U}^{12}$
\\
Motor module displacement arm: $\vec{L}_{arm}=195.16~~[mm]$
\\
Euler Rates: $\frac{d}{dt}\vec{\eta}=\dot{\vec{\eta}}=\Phi(\eta)\dot{\omega}_b=\begin{bmatrix}
\dot{\phi} & \dot{\theta} & \dot{\psi}
\end{bmatrix}^T~~~~\in\mathcal{F}^{v1,v2,I}$
\\
Angular Velocity: $\omega=\begin{bmatrix}
p & q & r\\
\end{bmatrix}^T~\in\mathcal{F}^b$
\\
Linear Velocity: $\nu=\begin{bmatrix}
u & v & w
\end{bmatrix}^T~\in\mathcal{F}^b$
%---------------------------------------------------------------------
%	Dedication (optional)
%---------------------------------------------------------------------
%\begin{flushright}
%	\vspace*{10cm}
%	{\itshape dedication .....}
%\end{flushright}
%---------------------------------------------------------------------
%	Table of Contents
%---------------------------------------------------------------------
\tableofcontents

%---------------------------------------------------------------------
%	List of Figures
%---------------------------------------------------------------------
\listoffigures

%---------------------------------------------------------------------
%	List of Tables
%---------------------------------------------------------------------
\listoftables

%---------------------------------------------------------------------
%	List of Symbols/Document conventions (optional)
%---------------------------------------------------------------------

%---------------------------------------------------------------------
%	Glossary (optional)
%---------------------------------------------------------------------

%=====================================================================
%	MAIN MATTER
%=====================================================================
% Create a separate file for each chapter. You may chose to rename these
% chapters as needed.
%---------------------------------------------------------------------
\mainmatter

\include{ch1}
\include{ch2}
\include{ch3}
\include{ch4}

\include{ch5}
\include{ch6}
\include{ch7}
\include{appendix}

%=====================================================================
%	BACK MATTER
%=====================================================================

\backmatter

%---------------------------------------------------------------------
%	BIBLIOGRAPHY
%---------------------------------------------------------------------

\bibliographystyle{plain}
\bibliography{thesis}

%---------------------------------------------------------------------
\end{document}
%---------------------------------------------------------------------
%	End of the document
%=====================================================================
